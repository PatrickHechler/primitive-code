|:
| Hello World code which prints the first 22 elements of file on the default out stream
|>
JMP START
:
	#OUT-FILE-NAME-SIZE 12 |> number of int64 elements
	#OUT-FILE-STRING --POS--
	45 |> strlen
	CHARS 'UTF-16LE' ".\\src\\test\\resources\\readfiles\\helloworld.txt"
	
>
@START
#GET_IP-POS --POS--
GET_IP BX
SUB BX , #GET_IP-POS
#GET_IP-POS ~DEL
ADD BX , #OUT-FILE-STRING
MOV AX , #INT-STREAMS-NEW_IN
INT #INT-STREAMS

|:	AX=INPUT_FILE-STREAM-ID
	BX=FILE_NAME
	CX=?
	DX=? |>

MOV DX , AX
MOV BX , 20
MOV AX , #INT-MEMORY-ALLOC
INT #INT-MEMORY

|:	AX=X
	BX=MEMORY-BLOCK
	CX=?
	DX=INPUT_FILE-STREAM-ID |>

MOV AX , DX
MOV DX , BX |> swap BX and DX
MOV BX , AX

MOV CX , #OUT-FILE-NAME-SIZE
MOV AX , #INT-STREAMS-READ
INT #INT-STREAMS

|:	AX=READ-ELEMENTS
	BX=X
	CX=X
	DX=MEMORY-BLOCK |>

MOV CX , AX
MOV AX , #INT-STREAMS-GET_OUT
INT #INT-STREAMS

|:	AX=DEF-OUT
	BX=X
	CX=READ-ELEMENTS
	DX=MEMORY-BLOCK |>

MOV BX , AX
MOV AX , #INT-STREAMS-WRITE
INT #INT-STREAMS

|:	AX=WRITTEN-ELEMENTS
	BX=X
	CX=READ-ELEMENTS
	DX=MEMORY-BLOCK |>

MOV BX, DX
MOV AX, #INT-MEMORY-FREE
INT #INT-MEMORY

|:	AX=X
	BX=X
	CX=READ-ELEMENTS
	DX=FREED-MEMORY-BLOCK |>

|> Exit progress
MOV BX , 0 |> EXIT-SUCCESS
MOV AX , #INT-ERRORS-EXIT
INT #INT-ERRORS
